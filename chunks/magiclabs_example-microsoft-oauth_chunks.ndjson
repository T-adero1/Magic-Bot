{"code": "<!DOCTYPE html>\n<html>\n  <head>\n    <title>Magic / microsoft OAuth Demo</title>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"styles.css\" />\n    <link\n      rel=\"stylesheet\"\n      href=\"//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/default.min.css\"\n    />\n    <script src=\"//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/highlight.min.js\"></script>\n    <script src=\"https://auth.magic.link/sdk\"></script>\n    <script src=\"https://auth.magic.link/sdk/extension/oauth\"></script>\n    <script>\n      const MAGIC_API_KEY = \"pk_live_78EABCE90112A046\";\n\n      const magic = new Magic(MAGIC_API_KEY, {\n        extensions: [new MagicOAuthExtension()],\n      });\n\n      const render = async () => {\n        let html = ``;\n\n        if (window.location.pathname === \"/callback\") {\n          try {\n            const result = await magic.oauth.getRedirectResult();", "explanation": "**Summary:**\n\nThis block is an HTML page that demonstrates a Magic / Microsoft OAuth integration. It uses JavaScript libraries to load styles, highlight code, and interact with the Magic SDK for authentication purposes. The primary functionality is to authenticate users using the Magic OAuth extension.", "metadata": {"repo": "magiclabs/example-microsoft-oauth", "file": "index.html", "chunk_number": 1, "total_chunks": 3}, "repository_explanation": "Here is a concise explanation:\n\n**Repository:** `magiclabs/example-microsoft-oauth`\n\n**Purpose:** Demonstrates Microsoft OAuth authentication using Magic Labs (a software development platform).\n\n**Content:** A basic example implementation of Microsoft OAuth flow, showcasing how to obtain an access token to authenticate users with Microsoft accounts.", "file_summary": "Here is a concise summary of the file 'index.html':\n\n**Summary:**\n\nThis HTML page integrates Magic/Microsoft OAuth for user authentication, handling login flow, displaying user profile on success, and redirecting to homepage or login form on error or cancellation."}
{"code": "            const profile = JSON.stringify(result.oauth.userInfo, undefined, 2);\n\n            html = `\n                <h1>It Worked! \ud83c\udf89</h1>\n                <h2>Your User Profile:</h2>\n                <pre><code class=\"json tomorrow\">${profile}</code></pre>\n              `;\n          } catch {\n            window.location.href = window.location.origin;\n          }\n        } else {\n          html = `\n              <h2>Please sign up or log in</h2>\n              <form onsubmit=\"handleLogin(event)\">\n                <button id=\"btn-send\" class=\"microsoft\" type=\"submit\">\n                  <img src=\"./login-with-microsoft.png\" />\n                </button>\n              </form>\n            `;\n        }\n\n        document.getElementById(\"app\").innerHTML = html;\n        document.querySelectorAll(\"pre code\").forEach((block) => {\n          hljs.highlightBlock(block);\n        });\n      };\n\n      /**\n       * Starts the OAuth 2.0 login flow.\n       */\n      const handleLogin = async (e) => {\n        e.preventDefault();\n", "explanation": "Here is a concise summary:\n\n**Functionality:**\n\n* Handles OAuth 2.0 login flow using Microsoft\n* Upon successful login, displays user profile in JSON format\n* On error or cancellation, redirects to homepage\n* Also provides a login form for non-logged-in users", "metadata": {"repo": "magiclabs/example-microsoft-oauth", "file": "index.html", "chunk_number": 2, "total_chunks": 3}, "repository_explanation": "Here is a concise explanation:\n\n**Repository:** `magiclabs/example-microsoft-oauth`\n\n**Purpose:** Demonstrates Microsoft OAuth authentication using Magic Labs (a software development platform).\n\n**Content:** A basic example implementation of Microsoft OAuth flow, showcasing how to obtain an access token to authenticate users with Microsoft accounts.", "file_summary": "Here is a concise summary of the file 'index.html':\n\n**Summary:**\n\nThis HTML page integrates Magic/Microsoft OAuth for user authentication, handling login flow, displaying user profile on success, and redirecting to homepage or login form on error or cancellation."}
{"code": "        // Render a button \"pending\" state.\n        const btnSend = document.getElementById(\"btn-send\");\n        btnSend.disabled = true;\n        btnSend.innerText = \"Logging in...\";\n\n        // Start the microsoft OAuth 2.0 flow!\n        const didToken = await magic.oauth.loginWithRedirect({\n          provider: \"microsoft\",\n          redirectURI: `${window.location.origin}/callback`\n        });\n      };\n    </script>\n  </head>\n  <body onload=\"render()\">\n    <div id=\"app\">Loading...</div>\n  </body>\n</html>\n", "explanation": "**Purpose:** Temporarily disable a button, display a \"logging in...\" text, and start a Microsoft OAuth login flow.\n\n**Functionality:** The code enables a redirect to a callback page after disabling a send button and displaying a pending state.", "metadata": {"repo": "magiclabs/example-microsoft-oauth", "file": "index.html", "chunk_number": 3, "total_chunks": 3}, "repository_explanation": "Here is a concise explanation:\n\n**Repository:** `magiclabs/example-microsoft-oauth`\n\n**Purpose:** Demonstrates Microsoft OAuth authentication using Magic Labs (a software development platform).\n\n**Content:** A basic example implementation of Microsoft OAuth flow, showcasing how to obtain an access token to authenticate users with Microsoft accounts.", "file_summary": "Here is a concise summary of the file 'index.html':\n\n**Summary:**\n\nThis HTML page integrates Magic/Microsoft OAuth for user authentication, handling login flow, displaying user profile on success, and redirecting to homepage or login form on error or cancellation."}
{"code": "{\n  \"infiniteLoopProtection\": true,\n  \"hardReloadOnChange\": true,\n  \"view\": \"browser\",\n  \"template\": \"static\"\n}\n", "explanation": "This block sets configuration options for a web application or browser:\n\n* Enables infinite loop protection\n* Automatically reloads on changes\n* Specifies display view as \"browser\"\n* Uses a static template", "metadata": {"repo": "magiclabs/example-microsoft-oauth", "file": "sandbox.config.json", "chunk_number": 1, "total_chunks": 1}, "repository_explanation": "Here is a concise explanation:\n\n**Repository:** `magiclabs/example-microsoft-oauth`\n\n**Purpose:** Demonstrates Microsoft OAuth authentication using Magic Labs (a software development platform).\n\n**Content:** A basic example implementation of Microsoft OAuth flow, showcasing how to obtain an access token to authenticate users with Microsoft accounts.", "file_summary": "Here is a concise and holistic summary of the 'sandbox.config.json' file:\n\n**Sandbox Configuration**\n\nEnables infinite loop protection, auto-reloads on changes, and sets display view to \"browser\" with a static template."}
{"code": "body {\n  font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto,\n    Oxygen-Sans, Ubuntu, Cantarell, \"Helvetica Neue\", sans-serif;\n  height: 100vh;\n  display: grid;\n  font-size: 18px;\n}\n\n#app {\n  align-self: center;\n  justify-self: center;\n  text-align: center;\n  width: 500px;\n  padding: 27px 18px;\n}\n\nh1 {\n  margin: 0;\n  padding-bottom: 1.5rem;\n  font-size: 36px;\n}\n\nh2 {\n  margin: 0;\n  padding-bottom: 18px;\n  font-size: 18px;\n}\n\ninput,\nbutton:not(.microsoft) {\n  padding: 9px;\n  font-size: 18px;\n  margin-bottom: 9px;\n}\n\nbutton.microsoft {\n  cursor: pointer;\n  border: none;\n  background: transparent;\n  padding: 0;\n}\n\nbutton.microsoft img {\n  max-height: 50px;\n  height: 100%;\n}\n\npre {\n  text-align: left;\n  background: #f0f0f0;\n  padding: 25px;\n  border-radius: 10px;\n  overflow-x: scroll;\n}\n", "explanation": "Here is a summary of the purpose and functionality of this block:\n\n**Purpose:** Stylesheet (CSS) code that defines visual layout and design rules for an application.\n\n**Functionality:** Defines font, size, padding, margin, alignment, and background styles for various HTML elements, including text, buttons, inputs, and preformatted content.", "metadata": {"repo": "magiclabs/example-microsoft-oauth", "file": "styles.css", "chunk_number": 1, "total_chunks": 1}, "repository_explanation": "Here is a concise explanation:\n\n**Repository:** `magiclabs/example-microsoft-oauth`\n\n**Purpose:** Demonstrates Microsoft OAuth authentication using Magic Labs (a software development platform).\n\n**Content:** A basic example implementation of Microsoft OAuth flow, showcasing how to obtain an access token to authenticate users with Microsoft accounts.", "file_summary": "Here is a concise summary of the file 'styles.css':\n\n**Stylesheet (CSS) code that defines visual layout and design rules for an application.**"}
