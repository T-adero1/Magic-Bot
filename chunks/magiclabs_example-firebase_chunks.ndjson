{"code": "<!DOCTYPE html>\n<html>\n  <head>\n    <title>Magic Apple Store \ud83c\udf4e</title>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"styles.css\" />\n    <script src=\"https://auth.magic.link/sdk\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/7.11.0/firebase-app.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/7.11.0/firebase-auth.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/7.11.0/firebase-firestore.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/7.11.0/firebase-functions.js\"></script>\n    <script>\n      const magic = new Magic(\"pk_live_3DB9AB619B7FD471\");\n\n      const firebaseConfig = {\n        apiKey: \"AIzaSyDiCyfh63_I8Bo-FPnEQ1K_f5kKFOZpVhw\",\n        authDomain: \"fir-demo-integration.firebaseapp.com\",\n        databaseURL: \"https://fir-demo-integration.firebaseio.com\",\n        projectId: \"fir-demo-integration\",", "explanation": "Here is a concise summary:\n\n**HTML Block Summary**\n\nThis HTML block defines a basic web page with a title, meta tags, and CSS and JavaScript links. It also initializes Firebase SDKs (Authentication, Firestore, and Functions) and Magic Link authentication, with credentials stored in script variables.", "metadata": {"repo": "magiclabs/example-firebase", "file": "index.html", "chunk_number": 1, "total_chunks": 5}, "repository_explanation": "I don't see a specific repository mentioned in your request. Could you please provide more context or specify the name of the repository, so I can give you an accurate answer?", "file_summary": "Here is a concise summary of the file 'index.html':\n\nThis HTML file defines a basic web page that integrates with Firebase and Magic Link authentication. It displays user-specific information and allows interaction options, such as buying \"apples\" (points/rewards) and logging out. The file initializes Firestore database instances, updates user data upon page load, and increments the apple count for the logged-in user."}
{"code": "        storageBucket: \"fir-demo-integration.appspot.com\",\n        messagingSenderId: \"550400757157\",\n        appId: \"1:550400757157:web:c835e300e6854e4fc26c4c\",\n        measurementId: \"G-Q79D0S1GE1\"\n      };\n\n      /* Initialize Firebase */\n      firebase.initializeApp(firebaseConfig);\n      const db = firebase.firestore();\n      const usersCollection = db.collection(\"users\");\n\n      const render = async () => {\n        /* Show login form if user is not logged in */\n        const currentUser = firebase.auth().currentUser;\n        let html = `\n          <h1>Please sign up or login</h1>\n          <form onsubmit=\"handleLogin(event)\">\n            <input type=\"email\" name=\"email\" required=\"required\" placeholder=\"Enter your email\" />\n            <button id=\"btn-send\" type=\"submit\">Send</button>\n          </form>\n        `;\n        if (currentUser) {\n          try {\n            let user = await usersCollection.doc(currentUser.uid).get();\n            if (user.exists) {\n              let userData = user.data();", "explanation": "**Firebase Configuration and Initialization**\n\nThis block initializes Firebase with configuration settings, creates a Firestore database instance, and defines an asynchronous function `render()` that:\n\n* Shows a login form if the user is not logged in\n* Retrieves user data from the \"users\" collection in Firestore if the user is logged in", "metadata": {"repo": "magiclabs/example-firebase", "file": "index.html", "chunk_number": 2, "total_chunks": 5}, "repository_explanation": "I don't see a specific repository mentioned in your request. Could you please provide more context or specify the name of the repository, so I can give you an accurate answer?", "file_summary": "Here is a concise summary of the file 'index.html':\n\nThis HTML file defines a basic web page that integrates with Firebase and Magic Link authentication. It displays user-specific information and allows interaction options, such as buying \"apples\" (points/rewards) and logging out. The file initializes Firestore database instances, updates user data upon page load, and increments the apple count for the logged-in user."}
{"code": "              let appleCount = userData.appleCount;\n              let appleDisplay =\n                appleCount > 0\n                  ? \"\ud83c\udf4e\".repeat(appleCount)\n                  : \"You have no apples...\";\n              html = `\n              <h1>Current user: ${userData.email}</h1>\n              <div id=\"apple-count\">${appleDisplay}</div>\n              <button onclick=\"handleBuyApple()\">Buy Apple</button>\n              <button onclick=\"handleLogout()\">Logout</button>\n            `;\n            }\n          } catch (err) {\n            console.error(err);\n          }\n        }\n        document.getElementById(\"app\").innerHTML = html;\n      };\n\n      const handleLogin = async e => {\n        e.preventDefault();\n        const email = new FormData(e.target).get(\"email\");\n        if (email) {\n          const btnSend = document.getElementById(\"btn-send\");\n          btnSend.disabled = true;\n          btnSend.innerText = \"Logging in...\";\n          /* One-liner login \ud83e\udd2f */", "explanation": "Here is a concise summary:\n\n**Functionality:**\n\n* Updates HTML content with user data and apple count display\n* Allows buying apples or logging out through buttons\n* Handles login functionality, disabling and updating the login button during processing\n\n**Purpose:**\n\n* To display user-specific information and provide interaction options", "metadata": {"repo": "magiclabs/example-firebase", "file": "index.html", "chunk_number": 3, "total_chunks": 5}, "repository_explanation": "I don't see a specific repository mentioned in your request. Could you please provide more context or specify the name of the repository, so I can give you an accurate answer?", "file_summary": "Here is a concise summary of the file 'index.html':\n\nThis HTML file defines a basic web page that integrates with Firebase and Magic Link authentication. It displays user-specific information and allows interaction options, such as buying \"apples\" (points/rewards) and logging out. The file initializes Firestore database instances, updates user data upon page load, and increments the apple count for the logged-in user."}
{"code": "          const didToken = await magic.auth.loginWithMagicLink({ email });\n          const auth = firebase.functions().httpsCallable(\"auth\");\n          let result = (await auth({ didToken })).data;\n          await firebase.auth().signInWithCustomToken(result.token);\n          let user = await usersCollection.doc(result.uid).get();\n          if (!user.exists) {\n            /* Add new user to database */\n            let newUser = {\n              email: email,\n              appleCount: 0\n            };\n            await usersCollection.doc(result.uid).set(newUser);\n            console.log(`User ${email} just signed up!`);\n          }\n          render();\n        }\n      };\n\n      const handleLogout = async () => {\n        await magic.user.logout();\n        await firebase.auth().signOut();\n        render();\n      };\n\n      const handleBuyApple = async () => {\n        const currentUser = firebase.auth().currentUser;\n        if (currentUser) {\n          let user = await usersCollection.doc(currentUser.uid).get();", "explanation": "Here is a concise summary:\n\n**Functionality:**\n\n* Logs in a user with Magic Link authentication\n* Signs in with Firebase Custom Token\n* Checks if user exists in database, and creates new user if not\n* Allows logout functionality\n* Enables buying \"apples\" (presumably points or rewards) for the current user.", "metadata": {"repo": "magiclabs/example-firebase", "file": "index.html", "chunk_number": 4, "total_chunks": 5}, "repository_explanation": "I don't see a specific repository mentioned in your request. Could you please provide more context or specify the name of the repository, so I can give you an accurate answer?", "file_summary": "Here is a concise summary of the file 'index.html':\n\nThis HTML file defines a basic web page that integrates with Firebase and Magic Link authentication. It displays user-specific information and allows interaction options, such as buying \"apples\" (points/rewards) and logging out. The file initializes Firestore database instances, updates user data upon page load, and increments the apple count for the logged-in user."}
{"code": "          if (user.exists) {\n            await usersCollection.doc(currentUser.uid).update({\n              appleCount: user.data().appleCount + 1\n            });\n            render();\n          }\n        }\n      };\n    </script>\n  </head>\n  <body onload=\"render()\">\n    <div id=\"app\">Loading...</div>\n  </body>\n</html>\n", "explanation": "Here is a concise summary of the code block's purpose and functionality:\n\n**Purpose:** Update user data in Firestore database upon page load.\n\n**Functionality:** Increments \"appleCount\" by 1 for the currently logged-in user, then re-renders the application.", "metadata": {"repo": "magiclabs/example-firebase", "file": "index.html", "chunk_number": 5, "total_chunks": 5}, "repository_explanation": "I don't see a specific repository mentioned in your request. Could you please provide more context or specify the name of the repository, so I can give you an accurate answer?", "file_summary": "Here is a concise summary of the file 'index.html':\n\nThis HTML file defines a basic web page that integrates with Firebase and Magic Link authentication. It displays user-specific information and allows interaction options, such as buying \"apples\" (points/rewards) and logging out. The file initializes Firestore database instances, updates user data upon page load, and increments the apple count for the logged-in user."}
{"code": "{\n  \"infiniteLoopProtection\": true,\n  \"hardReloadOnChange\": true,\n  \"view\": \"browser\"\n}\n", "explanation": "This block appears to be a configuration object with three properties:\n\n* `infiniteLoopProtection`: Enables protection against infinite loops.\n* `hardReloadOnChange`: Forces a full page reload when changes are detected.\n* `view`: Specifies the default view as \"browser\".", "metadata": {"repo": "magiclabs/example-firebase", "file": "sandbox.config.json", "chunk_number": 1, "total_chunks": 1}, "repository_explanation": "I don't see a specific repository mentioned in your request. Could you please provide more context or specify the name of the repository, so I can give you an accurate answer?", "file_summary": "Here is a concise summary of the file 'sandbox.config.json':\n\nThe `sandbox.config.json` file contains configuration settings for a sandbox environment, including protection against infinite loops, a full page reload policy, and a default view setting."}
{"code": "body {\n  font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto,\n    Oxygen-Sans, Ubuntu, Cantarell, \"Helvetica Neue\", sans-serif;\n  height: 100vh;\n  display: grid;\n  font-size: 18px;\n}\n\n#app {\n  align-self: center;\n  justify-self: center;\n  background-color: #eee;\n  text-align: center;\n  width: 300px;\n  padding: 27px 18px;\n}\n\nh1 {\n  margin: 0;\n  padding-bottom: 18px;\n  font-size: 18px;\n}\n\ninput,\nbutton {\n  padding: 9px;\n  font-size: 18px;\n  margin-bottom: 9px;\n}\n\n#apple-count {\n  margin-bottom: 18px;\n  background-color: #ddd;\n  padding: 9px 0;\n}\n", "explanation": "Here is a concise summary of the purpose and functionality of this block:\n\n**Styles for a Web Page**\n\nThis block defines CSS styles for a web page, controlling layout, typography, spacing, and colors across various HTML elements (e.g., body, header, input fields).", "metadata": {"repo": "magiclabs/example-firebase", "file": "styles.css", "chunk_number": 1, "total_chunks": 1}, "repository_explanation": "I don't see a specific repository mentioned in your request. Could you please provide more context or specify the name of the repository, so I can give you an accurate answer?", "file_summary": "Here is a concise summary of the file 'styles.css':\n\n**Summary:** Styles.css defines CSS styles for a web page, covering layout, typography, spacing, and colors for various HTML elements."}
